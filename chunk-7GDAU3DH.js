import{b as A,c as _,d as B,e as H,f as U}from"./chunk-AK23MYZF.js";import"./chunk-7RWCIHFI.js";import"./chunk-KQLLMZD5.js";import{b as D,d as x,r as v}from"./chunk-5DCULCAW.js";import"./chunk-BTCLMHBV.js";import{ya as w}from"./chunk-ZCK6LY7T.js";import{B as d,Fb as m,G as n,Gb as p,Hb as y,Jc as S,Lc as E,Nb as I,V as f,Y as a,Yb as O,_a as h,a as b,b as C,ba as u,db as g,kb as k,n as t,o,pb as M,wb as P}from"./chunk-PUOMKCPY.js";var l=class s{mockPermissions=[{id:1,name:"READ",description:"Permiso de lectura"},{id:2,name:"WRITE",description:"Permiso de escritura"},{id:3,name:"DELETE",description:"Permiso para borrar datos"}];constructor(){}getAllPermissions(){return t([...this.mockPermissions]).pipe(n(600))}getPermissionById(e){let i=this.mockPermissions.find(r=>r.id===e);return t(i).pipe(n(500))}createPermission(e){let i=C(b({},e),{id:this.mockPermissions.length+1});return this.mockPermissions.push(i),t(i).pipe(n(500))}updatePermission(e){let i=this.mockPermissions.findIndex(r=>r.id===e.id);return i!==-1&&(this.mockPermissions[i]=e),t(e).pipe(n(500))}deletePermission(e){return this.mockPermissions=this.mockPermissions.filter(i=>i.id!==e),t({success:!0}).pipe(n(500))}static \u0275fac=function(i){return new(i||s)};static \u0275prov=a({token:s,factory:s.\u0275fac,providedIn:"root"})};var c=class s{constructor(e,i){this.http=e;this.mockService=i;this.baseUrl=v.apiUrl,this.useMockData=v.useMockData,console.log(`RolesService initialized with ${this.useMockData?"MOCK":"REAL"} data source`)}baseUrl;useMockData;getAuthHeaders(){let e=localStorage.getItem("token");return e?new D({"Content-Type":"application/json",Authorization:`Bearer ${e}`}):null}getAllPermissions(){if(this.useMockData)return this.mockService.getAllPermissions();let e=this.getAuthHeaders();return e?this.http.get(`${this.baseUrl}/permissions`,{headers:e}).pipe(f(i=>console.log("Permissions fetched:",i)),d(i=>this.handleError("getAllPermissions",i))):o(()=>new Error("Authentication token not found."))}getPermissionById(e){if(this.useMockData)return this.mockService.getPermissionById(e);let i=this.getAuthHeaders();return i?this.http.get(`${this.baseUrl}/permissions/${e}`,{headers:i}).pipe(f(r=>console.log("Permission fetched:",r)),d(r=>this.handleError("getPermissionById",r))):o(()=>new Error("Authentication token not found."))}handleError(e,i){return console.error(`${e} failed:`,i.message),o(()=>new Error(`Error in ${e}: ${i.message}`))}static \u0275fac=function(i){return new(i||s)(u(x),u(l))};static \u0275prov=a({token:s,factory:s.\u0275fac,providedIn:"root"})};function R(s,e){s&1&&(m(0,"div",4),y(1,"mat-spinner",5),p())}var T=class s{constructor(e,i){this.permissionsService=e;this.snackBar=i}permissions=[];adaptedPermissionsData=[];isLoading=!0;displayedColumns=["nameId","description"];ngOnInit(){this.loadPermissions()}loadPermissions(){this.isLoading=!0,this.permissionsService.getAllPermissions().subscribe({next:e=>{this.permissions=e,this.adaptPermissionsToUserData(),this.isLoading=!1},error:e=>{console.error("Error fetching permissions:",e),this.snackBar.open("Failed to load permissions","Close",{duration:5e3,panelClass:["error-snackbar"]}),this.isLoading=!1}})}adaptPermissionsToUserData(){this.adaptedPermissionsData=this.permissions.map(e=>({id:e.id.toString(),name:e.name,lastName:"",username:`${e.name.toLowerCase()}`,email:`${e.name.toLowerCase()}@permissions.app`,password:"",role:"Admin",status:"Active",photoUrl:"assets/images/default-permission-icon.png",originalRole:e}))}applyFilter(e){console.log("Filter value:",e)}static \u0275fac=function(i){return new(i||s)(g(c),g(_))};static \u0275cmp=k({type:s,selectors:[["app-permissions"]],decls:6,vars:3,consts:[[1,"permissions-container"],[1,"header"],["class","loading-spinner",4,"ngIf"],[3,"filterChange","displayedColumns","userData"],[1,"loading-spinner"],["diameter","40"]],template:function(i,r){i&1&&(m(0,"div",0)(1,"div",1)(2,"h1"),O(3,"Permissions"),p()(),M(4,R,2,0,"div",2),m(5,"app-users-table",3),I("filterChange",function($){return r.applyFilter($)}),p()()),i&2&&(h(4),P("ngIf",r.isLoading),h(),P("displayedColumns",r.displayedColumns)("userData",r.adaptedPermissionsData))},dependencies:[E,S,A,w,U,H,B],styles:['@charset "UTF-8";html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{font-family:Murecho,sans-serif;height:100vh;margin:0;padding:0;overflow:hidden}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}h1[_ngcontent-%COMP%]{margin:0;font-family:Murecho,sans-serif!important}@media (max-width: 1023px){.header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.loading-spinner[_ngcontent-%COMP%]{height:60vh}}@media (max-width: 767px){.header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}h1[_ngcontent-%COMP%]{font-size:24px}.loading-spinner[_ngcontent-%COMP%]{height:60vh}}']})};export{T as PermissionsComponent};
