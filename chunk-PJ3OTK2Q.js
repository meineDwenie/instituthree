import{a as De}from"./chunk-K6CG6OZD.js";import{a as fe,b as Ue}from"./chunk-YQX5TNYQ.js";import{a as E,b as O,c as be,d as I,e as F,f as T,g as S}from"./chunk-YEFIVP7E.js";import{a as we,b as Ce,c as _e,d as Me}from"./chunk-MXKXLBHX.js";import{a as ge}from"./chunk-YNFTKU7D.js";import{b as ue}from"./chunk-UYOCD7B4.js";import{a as G}from"./chunk-FXHPCVZO.js";import"./chunk-LCBHQNYP.js";import{b as P,d as K}from"./chunk-DI2GF6D7.js";import{a as he,b as ve}from"./chunk-BOFTZJPA.js";import{I as pe,K as ce,M as D,N as x,b as ne,c as se,g as le,h as me,k as de}from"./chunk-Z7IPVWHD.js";import{b as Z,d as U,f as Q,g as X,j as Y,k as ee,l as te,m as re,n as ae,o as oe,p as ie}from"./chunk-3NOR6IXB.js";import"./chunk-AZTHPTC5.js";import{B as b,Fb as i,G as f,Gb as o,Hb as d,Hc as W,Ic as N,Kc as M,Nb as v,Ob as L,V as h,Y as k,Ya as A,Yb as n,Zb as V,_a as l,_b as y,a as w,b as H,ba as z,db as g,kb as _,n as u,o as C,pb as p,r as J,wb as m}from"./chunk-RHI7NKML.js";var R=class a{constructor(e,r){this.dialogRef=e;this.data=r}onCancel(){this.dialogRef.close(!1)}onConfirmDelete(){this.dialogRef.close(!0)}static \u0275fac=function(r){return new(r||a)(g(E),g(O))};static \u0275cmp=_({type:a,selectors:[["app-delete-user-dialog"]],decls:19,vars:3,consts:[[1,"delete-dialog-container"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"confirmation-message"],[1,"user-info-box"],[1,"user-details"],["alt","User photo",1,"user-avatar",3,"src"],[1,"user-text"],[1,"user-name"],[1,"user-id"],["mat-dialog-actions","","align","end"],["mat-button","",1,"cancel-button",3,"click"],["mat-raised-button","","color","warn",3,"click"]],template:function(r,t){r&1&&(i(0,"div",0)(1,"h2",1),n(2,"Confirm User Deletion"),o(),i(3,"div",2)(4,"p",3),n(5," Are you sure you want to delete this user? "),o(),i(6,"div",4)(7,"div",5),d(8,"img",6),i(9,"div",7)(10,"p",8),n(11),o(),i(12,"p",9),n(13),o()()()()(),i(14,"div",10)(15,"button",11),v("click",function(){return t.onCancel()}),n(16," Cancel "),o(),i(17,"button",12),v("click",function(){return t.onConfirmDelete()}),n(18," Delete "),o()()()),r&2&&(l(8),m("src",t.data.user.photoUrl,A),l(3),V(t.data.user.fullName),l(2),y("ID: ",t.data.user.id,""))},dependencies:[M,S,I,T,F,x,D],styles:[".delete-dialog-container[_ngcontent-%COMP%]{padding:6px 24px}h2[_ngcontent-%COMP%]{margin-bottom:16px;color:#333}.confirmation-message[_ngcontent-%COMP%]{font-size:16px;margin-bottom:20px;color:#555}.user-info-box[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:8px;padding:16px;background-color:#f0eeee;margin-bottom:16px;border:1px solid #000000}.user-details[_ngcontent-%COMP%]{display:flex;align-items:center}.user-avatar[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;object-fit:cover;margin-right:16px;border:1px solid #000000}.user-text[_ngcontent-%COMP%]{display:flex;flex-direction:column}.user-name[_ngcontent-%COMP%]{font-size:16px;font-weight:500;margin:0 0 4px}.user-id[_ngcontent-%COMP%]{font-size:14px;color:#666;margin:0}mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 0 0;margin-bottom:0}.mat-mdc-raised-button[_ngcontent-%COMP%]:not(:disabled){color:#fff;background-color:#ec6666;border-radius:10px;padding:0 40px}.mat-mdc-raised-button[_ngcontent-%COMP%]:not(:disabled):hover{background-color:#ec4e4e}.cancel-button[_ngcontent-%COMP%]{background-color:transparent;color:#f99191!important;padding:0 30px;border-radius:10px}.cancel-button[_ngcontent-%COMP%]:hover{color:#db6b6b!important;background-color:#fee!important}"]})};function Ne(a,e){a&1&&(i(0,"mat-error"),n(1,"Full name is required"),o())}function Ee(a,e){a&1&&(i(0,"mat-error"),n(1,"Name must be at least 3 characters"),o())}function Oe(a,e){a&1&&(i(0,"mat-error"),n(1,"Email is required"),o())}function Ie(a,e){a&1&&(i(0,"mat-error"),n(1,"Please enter a valid email"),o())}function Fe(a,e){a&1&&(i(0,"span"),n(1,"Password is required"),o())}function Te(a,e){a&1&&(i(0,"span"),n(1,"Minimum 6 characters"),o())}function Re(a,e){if(a&1&&(i(0,"mat-error"),p(1,Fe,2,0,"span",8)(2,Te,2,0,"span",8),o()),a&2){let r=L();l(),m("ngIf",r.password==null||r.password.errors==null?null:r.password.errors.required),l(),m("ngIf",r.password==null||r.password.errors==null?null:r.password.errors.minlength)}}function qe(a,e){if(a&1&&(i(0,"mat-option",21),n(1),o()),a&2){let r=e.$implicit;m("value",r),l(),y(" ",r," ")}}function Be(a,e){a&1&&(i(0,"mat-error"),n(1,"Role is required"),o())}function je(a,e){if(a&1&&(i(0,"mat-option",21),n(1),o()),a&2){let r=e.$implicit;m("value",r),l(),y(" ",r," ")}}function $e(a,e){a&1&&(i(0,"mat-error"),n(1,"Status is required"),o())}function ze(a,e){if(a&1&&(i(0,"div",22),d(1,"img",23),o()),a&2){let r,t=L();l(),m("src",(r=t.userForm.get("photoUrl"))==null?null:r.value,A)}}var B=class a{constructor(e,r,t){this.fb=e;this.dialogRef=r;this.data=t;this.userForm=this.fb.group({id:[{value:"",disabled:!0}],fullName:["",[U.required,U.minLength(3)]],email:["",[U.required,U.email]],password:["",[U.required,U.minLength(6)]],role:["",U.required],status:["",U.required],photoUrl:[""]})}userForm;roles=["Student","Professor","Admin","Tutor","Delegado"];statuses=["Active","Pending"];ngOnInit(){this.data.user&&this.userForm.patchValue(this.data.user)}onCancel(){this.dialogRef.close(!1)}onSave(){if(this.userForm.valid){let e=this.userForm.value;this.dialogRef.close(e)}else console.log("Form is invalid")}get fullName(){return this.userForm.get("fullName")}get email(){return this.userForm.get("email")}get role(){return this.userForm.get("role")}get status(){return this.userForm.get("status")}get password(){return this.userForm.get("password")}static \u0275fac=function(r){return new(r||a)(g(ae),g(E),g(O))};static \u0275cmp=_({type:a,selectors:[["app-add-user-dialog"]],decls:54,vars:13,consts:[[1,"dialog-container"],["mat-dialog-title",""],[3,"ngSubmit","formGroup"],["mat-dialog-content",""],[1,"form-row"],["appearance","outline",1,"full-width"],["matInput","","formControlName","id","readonly",""],["matInput","","formControlName","fullName","placeholder","Enter full name"],[4,"ngIf"],["matInput","","formControlName","email","placeholder","Enter email","type","email"],["matInput","","formControlName","password","required","",3,"type"],[1,"form-row","two-columns"],["appearance","outline"],["formControlName","role"],[3,"value",4,"ngFor","ngForOf"],["formControlName","status"],["matInput","","formControlName","photoUrl","placeholder","Enter photo URL"],["class","avatar-preview",4,"ngIf"],["mat-dialog-actions","","align","end"],["mat-button","","type","button",1,"cancel-button",3,"click"],["mat-raised-button","","type","submit",1,"save-button",3,"disabled"],[3,"value"],[1,"avatar-preview"],["alt","User avatar",3,"src"]],template:function(r,t){if(r&1&&(i(0,"div",0)(1,"h2",1),n(2,"Add New User"),o(),i(3,"form",2),v("ngSubmit",function(){return t.onSave()}),i(4,"div",3)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),n(8,"ID"),o(),d(9,"input",6),o()(),i(10,"div",4)(11,"mat-form-field",5)(12,"mat-label"),n(13,"Full Name"),o(),d(14,"input",7),p(15,Ne,2,0,"mat-error",8)(16,Ee,2,0,"mat-error",8),o()(),i(17,"div",4)(18,"mat-form-field",5)(19,"mat-label"),n(20,"Email"),o(),d(21,"input",9),p(22,Oe,2,0,"mat-error",8)(23,Ie,2,0,"mat-error",8),o()(),i(24,"div",4)(25,"mat-form-field",5)(26,"mat-label"),n(27,"Password"),o(),d(28,"input",10),p(29,Re,3,2,"mat-error",8),o()(),i(30,"div",11)(31,"mat-form-field",12)(32,"mat-label"),n(33,"Role"),o(),i(34,"mat-select",13),p(35,qe,2,2,"mat-option",14),o(),p(36,Be,2,0,"mat-error",8),o(),i(37,"mat-form-field",12)(38,"mat-label"),n(39,"Status"),o(),i(40,"mat-select",15),p(41,je,2,2,"mat-option",14),o(),p(42,$e,2,0,"mat-error",8),o()(),i(43,"div",4)(44,"mat-form-field",5)(45,"mat-label"),n(46,"Photo URL"),o(),d(47,"input",16),o()(),p(48,ze,2,1,"div",17),o(),i(49,"div",18)(50,"button",19),v("click",function(){return t.onCancel()}),n(51," Cancel "),o(),i(52,"button",20),n(53," Save "),o()()()()),r&2){let s;l(3),m("formGroup",t.userForm),l(12),m("ngIf",t.fullName==null||t.fullName.errors==null?null:t.fullName.errors.required),l(),m("ngIf",t.fullName==null||t.fullName.errors==null?null:t.fullName.errors.minlength),l(6),m("ngIf",t.email==null||t.email.errors==null?null:t.email.errors.required),l(),m("ngIf",t.email==null||t.email.errors==null?null:t.email.errors.email),l(5),m("type","password"),l(),m("ngIf",(t.password==null?null:t.password.invalid)&&((t.password==null?null:t.password.dirty)||(t.password==null?null:t.password.touched))),l(6),m("ngForOf",t.roles),l(),m("ngIf",t.role==null||t.role.errors==null?null:t.role.errors.required),l(5),m("ngForOf",t.statuses),l(),m("ngIf",t.status==null||t.status.errors==null?null:t.status.errors.required),l(6),m("ngIf",(s=t.userForm.get("photoUrl"))==null?null:s.value),l(4),m("disabled",!t.userForm.valid)}},dependencies:[M,W,N,S,I,T,F,me,le,ne,se,ve,he,ce,pe,de,x,D,oe,Y,Z,Q,X,re,ie,ee,te],styles:[".dialog-container[_ngcontent-%COMP%]{padding:0;max-width:500px}.form-row[_ngcontent-%COMP%]{margin-bottom:16px}.full-width[_ngcontent-%COMP%]{width:100%}.two-columns[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:16px}.avatar-preview[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:16px 0}.avatar-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;object-fit:cover;border:1px solid #ddd}h2[_ngcontent-%COMP%]{margin-bottom:0;color:#333}mat-dialog-content[_ngcontent-%COMP%]{margin-bottom:24px}mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 0;margin-bottom:0}.mat-mdc-raised-button[_ngcontent-%COMP%]:disabled{border-radius:10px;padding:0 40px}.mat-mdc-raised-button[_ngcontent-%COMP%]:not(:disabled){color:#fff;background-color:#577839;border-radius:10px;padding:0 40px}.mat-mdc-raised-button[_ngcontent-%COMP%]:not(:disabled):hover{background-color:#50722f}.cancel-button[_ngcontent-%COMP%]{color:#577839!important;padding:0 30px;border-radius:10px}.cancel-button[_ngcontent-%COMP%]:hover{background-color:#fafff5!important}"]})};var j=class a{mockUsers=[{id:"1001",fullName:"John Doe",email:"john.doe@example.com",password:"password123",role:"Student",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=1"},{id:"1002",fullName:"Jane Smith",email:"jane.smith@example.com",password:"password123",role:"Professor",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=5"},{id:"1003",fullName:"Robert Johnson",email:"robert.johnson@example.com",password:"password123",role:"Admin",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=8"},{id:"1004",fullName:"Emily Davis",email:"emily.davis@example.com",password:"password123",role:"Tutor",status:"Pending",photoUrl:"https://i.pravatar.cc/150?img=9"},{id:"1005",fullName:"Michael Wilson",email:"michael.wilson@example.com",password:"password123",role:"Student",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=11"},{id:"1006",fullName:"Sarah Taylor",email:"sarah.taylor@example.com",password:"password123",role:"Delegado",status:"Pending",photoUrl:"https://i.pravatar.cc/150?img=10"},{id:"1007",fullName:"David Brown",email:"david.brown@example.com",password:"password123",role:"Professor",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=12"},{id:"1008",fullName:"Jennifer Garcia",email:"jennifer.garcia@example.com",password:"password123",role:"Student",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=25"},{id:"1009",fullName:"Thomas Martinez",email:"thomas.martinez@example.com",password:"password123",role:"Tutor",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=15"},{id:"1010",fullName:"Lisa Robinson",email:"lisa.robinson@example.com",password:"password123",role:"Student",status:"Pending",photoUrl:"https://i.pravatar.cc/150?img=23"},{id:"1011",fullName:"Carlos Mendoza",email:"carlos.mendoza@example.com",password:"password123",role:"Student",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=30"},{id:"1012",fullName:"Elena Rodriguez",email:"elena.rodriguez@example.com",password:"password123",role:"Professor",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=31"},{id:"1013",fullName:"Nathan Black",email:"nathan.black@example.com",password:"password123",role:"Student",status:"Pending",photoUrl:"https://i.pravatar.cc/150?img=32"},{id:"1014",fullName:"Olivia White",email:"olivia.white@example.com",password:"password123",role:"Tutor",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=33"},{id:"1015",fullName:"Ahmed Hassan",email:"ahmed.hassan@example.com",password:"password123",role:"Student",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=34"},{id:"1016",fullName:"Maria Sanchez",email:"maria.sanchez@example.com",password:"password123",role:"Delegado",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=35"},{id:"1017",fullName:"James Wilson",email:"james.wilson@example.com",password:"password123",role:"Admin",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=36"},{id:"1018",fullName:"Zoe Thompson",email:"zoe.thompson@example.com",password:"password123",role:"Student",status:"Pending",photoUrl:"https://i.pravatar.cc/150?img=37"},{id:"1019",fullName:"Daniel Lee",email:"daniel.lee@example.com",password:"password123",role:"Professor",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=38"},{id:"1020",fullName:"Sophia Chen",email:"sophia.chen@example.com",password:"password123",role:"Student",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=39"},{id:"1021",fullName:"Isaac Patel",email:"isaac.patel@example.com",password:"password123",role:"Tutor",status:"Pending",photoUrl:"https://i.pravatar.cc/150?img=40"},{id:"1022",fullName:"Grace Kim",email:"grace.kim@example.com",password:"password123",role:"Student",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=41"},{id:"1023",fullName:"Miguel Gonzalez",email:"miguel.gonzalez@example.com",password:"password123",role:"Professor",status:"Pending",photoUrl:"https://i.pravatar.cc/150?img=42"},{id:"1024",fullName:"Emma Watson",email:"emma.watson@example.com",password:"password123",role:"Student",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=43"},{id:"1025",fullName:"Victor Nguyen",email:"victor.nguyen@example.com",password:"password123",role:"Delegado",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=44"},{id:"1026",fullName:"Sofia Perez",email:"sofia.perez@example.com",password:"password123",role:"Student",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=45"},{id:"1027",fullName:"Benjamin Scott",email:"benjamin.scott@example.com",password:"password123",role:"Tutor",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=46"},{id:"1028",fullName:"Isabella Torres",email:"isabella.torres@example.com",password:"password123",role:"Student",status:"Pending",photoUrl:"https://i.pravatar.cc/150?img=47"},{id:"1029",fullName:"William Sharma",email:"william.sharma@example.com",password:"password123",role:"Professor",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=48"},{id:"1030",fullName:"Amelia Jackson",email:"amelia.jackson@example.com",password:"password123",role:"Student",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=49"},{id:"1031",fullName:"Lucas Morales",email:"lucas.morales@example.com",password:"password123",role:"Admin",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=50"},{id:"1032",fullName:"Ava Campbell",email:"ava.campbell@example.com",password:"password123",role:"Student",status:"Pending",photoUrl:"https://i.pravatar.cc/150?img=51"},{id:"1033",fullName:"Noah Edwards",email:"noah.edwards@example.com",password:"password123",role:"Tutor",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=52"},{id:"1034",fullName:"Charlotte Greene",email:"charlotte.greene@example.com",password:"password123",role:"Student",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=53"},{id:"1035",fullName:"Liam Connor",email:"liam.oconnor@example.com",password:"password123",role:"Professor",status:"Active",photoUrl:"https://i.pravatar.cc/150?img=54"}];constructor(){}getUsers(){return u([...this.mockUsers]).pipe(f(800))}getUserById(e){let r=this.mockUsers.find(t=>t.id===e);return r?u(w({},r)).pipe(f(500)):u({}).pipe(f(500))}createUser(e){let r=H(w({},e),{id:this.generateId()});return this.mockUsers.push(r),u(w({},r)).pipe(f(800))}updateUser(e){let r=this.mockUsers.findIndex(t=>t.id===e.id);return r!==-1?(this.mockUsers[r]=w({},e),u(w({},e)).pipe(f(800))):u({}).pipe(f(500))}deleteUser(e){let r=this.mockUsers.findIndex(t=>t.id===e);return r!==-1?(this.mockUsers.splice(r,1),u(!0).pipe(f(800))):u(!1).pipe(f(500))}generateId(){let e=this.mockUsers.map(t=>parseInt(t.id,10));return(Math.max(...e)+1).toString()}static \u0275fac=function(r){return new(r||a)};static \u0275prov=k({token:a,factory:a.\u0275fac,providedIn:"root"})};var $=class a{constructor(e,r){this.http=e;this.mockService=r;this.baseUrl=G.apiUrl,this.useMockData=G.useMockData,console.log(`UsersService initialized with ${this.useMockData?"MOCK":"REAL"} data source`)}baseUrl;useMockData;getUsers(){if(this.useMockData)return this.mockService.getUsers();let e=localStorage.getItem("token");if(!e)return console.error("No authentication token found"),C(()=>new Error("Authentication token not found. Please login again."));let r=new P().set("Authorization",`Bearer ${e}`);return console.log("Making API request to:",`${this.baseUrl}/users`),console.log("With headers:",r),this.http.get(`${this.baseUrl}/users`,{headers:r}).pipe(h(t=>console.log("Raw users from API:",t)),J(t=>t.map(s=>({id:s.id.toString(),fullName:`${s.name} ${s.lastName}`,email:s.email,role:this.mapRole(s.username),status:s.status?"Active":"Pending",photoUrl:s.photoUrl||"",originalRole:s.username}))),h(t=>console.log("Mapped Users:",t)),b(t=>(console.error("getUsers failed:",t),t.status===401?(localStorage.removeItem("token"),localStorage.removeItem("currentUser"),C(()=>new Error("Authentication expired. Please login again."))):this.handleError("getUsers",[])(t))))}getUserById(e){return this.useMockData?this.mockService.getUserById(e):this.http.get(`${this.baseUrl}/users/${e}`).pipe(h(r=>console.log(`User fetched with id=${e}`)),b(this.handleError("getUserById")))}createUser(e){return this.useMockData?this.mockService.createUser(e):this.http.post(`${this.baseUrl}/users`,e).pipe(h(r=>console.log("User created:",r)),b(this.handleError("createUser")))}createUserRequest(e){let r=localStorage.getItem("token");if(!r)return console.error("No authentication token found"),C(()=>new Error("Authentication token is missing."));let t=new P().set("Authorization",`Bearer ${r}`);return this.http.post(`${this.baseUrl}/users`,e,{headers:t}).pipe(h(s=>console.log("User created:",s)),b(this.handleError("createUserRequest")))}updateUser(e){if(this.useMockData)return this.mockService.updateUser(e);let r=localStorage.getItem("token");if(!r)return console.error("No authentication token found"),C(()=>new Error("Authentication token is missing."));let t=new P().set("Authorization",`Bearer ${r}`);return this.http.put(`${this.baseUrl}/users/${e.id}`,e,{headers:t}).pipe(h(()=>console.log(`User updated with id = ${e.id}`)),b(this.handleError("updateUser")))}updateUserRequest(e,r){let t=localStorage.getItem("token");if(!t)return C(()=>new Error("Authentication token is missing."));let s=new P().set("Authorization",`Bearer ${t}`);return this.http.put(`${this.baseUrl}/users/${e}`,r,{headers:s}).pipe(h(()=>console.log(`User updated successfully from updateUserRequest with id = ${e}`)),b(this.handleError("updateUserRequest")))}deleteUser(e){return this.useMockData?this.mockService.deleteUser(e):this.http.delete(`${this.baseUrl}/users/${e}`).pipe(h(r=>console.log(`User deleted with id=${e}`)),b(this.handleError("deleteUser")))}setUseMockData(e){this.useMockData=e,console.log(`Switched to ${e?"MOCK":"REAL"} data source`)}handleError(e="operation",r){return t=>(console.error(`${e} failed: ${t.message}`),u(r))}mapRole(e){switch(e?.toLowerCase()){case"admin":return"Admin";case"professor":return"Professor";case"tutor":return"Tutor";case"delegado":return"Delegado";default:return"Student"}}static \u0275fac=function(r){return new(r||a)(z(K),z(j))};static \u0275prov=k({token:a,factory:a.\u0275fac,providedIn:"root"})};function He(a,e){a&1&&(i(0,"div",7),d(1,"mat-spinner",8),o())}var Pe=class a{constructor(e,r,t){this.usersService=e;this.dialog=r;this.snackBar=t}displayedColumns=["nameId","email","role","status","actions"];users=[];isLoading=!1;ngOnInit(){this.loadUsers()}loadUsers(){this.isLoading=!0,this.usersService.getUsers().subscribe({next:e=>{this.users=e,this.isLoading=!1},error:e=>{console.error("Error fetching users:",e),this.snackBar.open("Failed to load users. Please try again later.","Close",{duration:5e3}),this.isLoading=!1}})}handleEditUser(e){console.log("Edit user:",e),this.dialog.open(De,{width:"500px",data:{user:e}}).afterClosed().subscribe(t=>{t&&this.updateUser(t)})}handleDeleteUser(e){this.dialog.open(R,{width:"400px",data:{user:e}}).afterClosed().subscribe(t=>{t&&this.usersService.deleteUser(e.id).subscribe({next:()=>{this.snackBar.open("User deleted successfully","Close",{duration:3e3}),this.loadUsers()},error:s=>{console.error("Error deleting user:",s),this.snackBar.open("Failed to delete user. Please try again later.","Close",{duration:5e3})}})})}handleFilterChange(e){console.log("Filter applied:",e)}openAddUserDialog(){this.dialog.open(B,{width:"500px",data:{user:{}}}).afterClosed().subscribe(r=>{r&&this.addUser(r)})}updateUser(e){let[r,...t]=e.fullName.split(" "),s=t.join(" "),c={username:e.email.split("@")[0],password:e.password,email:e.email,name:r||"",lastName:s||"",status:e.status==="Active"};console.log("Update payload:",c),this.usersService.updateUserRequest(e.id,c).subscribe({next:()=>{this.snackBar.open("User updated successfully","Close",{duration:3e3}),this.loadUsers()},error:ke=>{console.error("Error updating user:",ke),this.snackBar.open("Failed to update user. Please try again later.","Close",{duration:5e3})}})}addUser(e){let[r,t]=e.fullName.split(" "),s={username:e.email.split("@")[0],password:e.password,email:e.email,name:r||"",lastName:t||"",status:e.status==="Active"};this.usersService.createUserRequest(s).subscribe({next:c=>{this.snackBar.open("User added successfully","Close",{duration:3e3}),this.loadUsers()},error:c=>{console.error("Error adding user:",c),this.snackBar.open("Failed to add user. Please try again later.","Close",{duration:5e3})}})}static \u0275fac=function(r){return new(r||a)(g($),g(be),g(we))};static \u0275cmp=_({type:a,selectors:[["app-user-management"]],decls:12,vars:3,consts:[[1,"user-management-container"],[1,"user-management-header"],[1,"actions"],["mat-raised-button","",1,"btn-adduser",3,"click"],[1,"bi","bi-plus",2,"margin-right","8px"],["class","loading-spinner",4,"ngIf"],[3,"editUser","deleteUser","filterChange","userData","displayedColumns"],[1,"loading-spinner"],["diameter","40"]],template:function(r,t){r&1&&(d(0,"app-header-nav")(1,"app-sidebar"),i(2,"main",0)(3,"div",1)(4,"h1"),n(5,"User Management"),o(),i(6,"div",2)(7,"button",3),v("click",function(){return t.openAddUserDialog()}),d(8,"i",4),n(9," Add new user "),o()()(),p(10,He,2,0,"div",5),i(11,"app-users-table",6),v("editUser",function(c){return t.handleEditUser(c)})("deleteUser",function(c){return t.handleDeleteUser(c)})("filterChange",function(c){return t.handleFilterChange(c)}),o()()),r&2&&(l(10),m("ngIf",t.isLoading),l(),m("userData",t.users)("displayedColumns",t.displayedColumns))},dependencies:[M,N,ue,ge,Ue,fe,x,D,S,Ce,Me,_e],styles:["html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{font-family:Murecho,sans-serif;height:100vh;margin:0;padding:0;overflow:hidden}body[_ngcontent-%COMP%]{background-color:#f6f6f6}.user-management-container[_ngcontent-%COMP%]{height:calc(100vh - 100px);padding:20px 50px;margin-left:320px;background-color:#f6f6f6}.user-management-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.user-management-header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center}h1[_ngcontent-%COMP%]{margin:0;font-family:Murecho,sans-serif!important}.user-table-wrapper[_ngcontent-%COMP%]{overflow-x:auto}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.user-info[_ngcontent-%COMP%]   .user-photo[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;object-fit:cover}.user-info[_ngcontent-%COMP%]   .user-name[_ngcontent-%COMP%]{font-weight:700}.user-info[_ngcontent-%COMP%]   .user-id[_ngcontent-%COMP%]{font-size:12px;color:gray}.btn-adduser[_ngcontent-%COMP%]{color:#000!important;background-color:#70d3c3!important;border-radius:10px;border:black 1px solid;display:flex;align-items:center;padding:0 14px;line-height:1}.loading-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh}"]})};export{Pe as UserManagementComponent};
